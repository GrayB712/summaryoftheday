<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Add Comment to GitHub</title>
  </head>
  <body>
    <h1>Add Comment to GitHub</h1>
    <form>
      <label for="comment">Enter your comment:</label><br>
      <textarea id="comment" name="comment" rows="5" cols="50"></textarea><br>
      <button type="submit">Submit</button>
    </form>
    <p id="error-message"></p>
    <script>
      let token = '';

      function getToken() {
        token = prompt('Enter your personal access token:');
      }

      getToken();

      function addComment(comment) {
        const repo = 'GrayB712/summaryoftheday';
        const path = 'Comments.txt';
        const url = `https://api.github.com/repos/${repo}/contents/${path}.git`;
        const message = `Add comment ${new Date().toISOString()}`;
        const content = btoa(comment);

        fetch(url, {
          method: 'PUT',
          headers: {
            Authorization: `Bearer ${token}`,
            'Content-Type': 'application/json',
            Accept: 'application/vnd.github.v3+json'
          },
          body: JSON.stringify({
            message: message,
            content: content
          })
        })
        .then(response => {
          if (!response.ok) {
            throw new Error(response.statusText);
          }
          return response.json();
        })
        .then(data => {
          const successMessage = `Comment added to ${data.content.html_url}`;
          const errorMessage = '';
          updateErrorMessage(successMessage, errorMessage);
        })
        .catch(error => {
          const successMessage = '';
          const errorMessage = error.message;
          updateErrorMessage(successMessage, errorMessage);
        });
      }

      function updateErrorMessage(successMessage, errorMessage) {
        const errorMessageElement = document.querySelector('#error-message');
        if (errorMessage) {
          errorMessageElement.textContent = errorMessage;
        } else {
          errorMessageElement.textContent = successMessage;
        }
      }

      const form = document.querySelector('form');
      form.addEventListener('submit', event => {
        event.preventDefault();
        const comment = document.querySelector('#comment').value;
        addComment(comment);
      });
    </script>
  </body>
</html>
